<main>
  <div
    class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom"
  >
    <h1 class="h2">Inicio</h1>
    <div class="btn-toolbar mb-2 mb-md-0">
      <div class="btn-group me-2">
        <button
          type="button"
          class="btn btn-sm btn-outline-secondary"
          data-bs-toggle="modal"
          data-bs-target="#agregar"
          (click)="agregar()"
        >
          Agregar
        </button>
        <button type="button" class="btn btn-sm btn-outline-secondary">
          Imprimir
        </button>
      </div>
      <button
        type="button"
        class="btn btn-sm btn-outline-secondary dropdown-toggle d-flex align-items-center gap-1"
      >
        <svg class="bi"><use xlink:href="#calendar3" /></svg>
        Ordenar por
      </button>
    </div>
  </div>

  <!-- Button trigger modal -->

  <!-- Modal -->
  <div
    class="modal fade"
    id="agregar"
    tabindex="-1"
    aria-labelledby="exampleModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1
            class="modal-title fs-5"
            id="exampleModalLabel"
            *ngIf="proceso_agregar"
          >
            Agregar vacante
          </h1>
          <h1
            class="modal-title fs-5"
            id="exampleModalLabel"
            *ngIf="proceso_editar"
          >
            Editar vacante
          </h1>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>
        <div class="modal-body">
          <form id="vacanteForm">
            <!-- ? Nombre de la Empresa -->
            <div class="mb-3">
              <label for="nombreEmpresa" class="form-label"
                >Nombre de la empresa</label
              >
              <input
                [(ngModel)]="form.nombreEmpresa"
                type="text"
                class="form-control"
                name="nombreEmpresa"
                id="nombreEmpresa"
                required
              />
            </div>

            <!-- ? Logo de la Empresa -->
            <div class="mb-3">
              <label for="logoEmpresa" class="form-label"
                >Logo de la empresa (URL)</label
              >
              <input
                [(ngModel)]="form.logoEmpresa"
                type="url"
                class="form-control"
                id="logoEmpresa"
                name="logoEmpresa"
                required
              />
              <img
                style="width: 25%"
                *ngIf="proceso_editar"
                src="{{ form.logoEmpresa }}"
                alt=""
              />
            </div>

            <!-- ? Oferta de la Vacante -->
            <label for="oferta" class="form-label">Oferta de la vacante</label>
            <input
              [(ngModel)]="form.oferta"
              type="text"
              class="form-control"
              name="oferta"
              id="oferta"
              required
            />

            <!-- ? Requisitos -->
            <div class="mb-3">
              <label for="requisitos" class="form-label"
                >Requisitos <i>(separados por guion medio ' - ')</i></label
              >
              <textarea
                [(ngModel)]="form.requisitos"
                class="form-control"
                id="requisitos"
                name="requisitos"
                rows="3"
                required
              ></textarea>
            </div>

            <!-- ? Horarios -->
            <div class="mb-3">
              <label for="horarios" class="form-label">Horarios</label>
              <textarea
                [(ngModel)]="form.horarios"
                class="form-control"
                id="horarios"
                name="horarios"
                rows="3"
                required
              ></textarea>
            </div>

            <!-- ? Prestaciones -->
            <div class="mb-3">
              <label for="prestaciones" class="form-label"
                >Prestaciones <i>(separados por guion medio ' - ')</i></label
              >
              <textarea
                [(ngModel)]="form.prestaciones"
                class="form-control"
                id="prestaciones"
                name="prestaciones"
                rows="3"
                required
              ></textarea>
            </div>

            <!-- ? Ubicación -->
            <div class="mb-3">
              <label for="ubicacion" class="form-label">Ubicación</label>
              <input
                [(ngModel)]="form.ubicacion"
                type="text"
                class="form-control"
                name="ubicacion"
                id="ubicacion"
                required
              />
            </div>

            <!-- ? Correos -->
            <div class="mb-3">
              <label for="correos" class="form-label"
                >Correos <i>(separados por guion medio ' - ')</i></label
              >
              <textarea
                [(ngModel)]="form.correos"
                class="form-control"
                name="correos"
                id="correos"
                rows="3"
                required
              ></textarea>
            </div>

            <!-- ? Teléfonos -->
            <div class="mb-3">
              <label for="telefonos" class="form-label"
                >Teléfonos <i>(separados por guion medio ' - ')</i></label
              >
              <textarea
                [(ngModel)]="form.telefonos"
                class="form-control"
                name="telefonos"
                id="telefonos"
                rows="2"
                required
              ></textarea>
            </div>

            <!-- ? WhatsApp -->
            <div class="mb-3">
              <label for="whatsapp" class="form-label"
                >WhatsApp <i>(separados por guion medio ' - ')</i></label
              >
              <textarea
                [(ngModel)]="form.whatsapp"
                class="form-control"
                name="whatsapp"
                id="whatsapp"
                rows="2"
                required
              ></textarea>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-secondary"
            data-bs-dismiss="modal"
          >
            Cerrar
          </button>
          <button
            (click)="publicar()"
            type="submit"
            form="vacanteForm"
            class="btn btn-primary"
            *ngIf="proceso_agregar"
          >
            Guardar
          </button>
          <button
            (click)="actualizar()"
            type="submit"
            form="vacanteForm"
            class="btn btn-primary"
            *ngIf="proceso_editar"
          >
            Actualizar
          </button>
        </div>
      </div>
    </div>
  </div>

  <h2>Section title</h2>
  <div class="table-responsive small">
    <table class="table table-striped table-sm">
      <thead>
        <tr>
          <th scope="col">Logo</th>
          <th scope="col">Empresa</th>
          <th scope="col">Vacante</th>
          <th scope="col">Requisitos</th>
          <th scope="col">Horarios</th>
          <th scope="col">Prestaciones</th>
          <th scope="col">Ubicación</th>
          <th scope="col">Correos</th>
          <th scope="col">Telefonos</th>
          <th scope="col">WhatsApp</th>
          <th scope="col">Editar</th>
          <th scope="col">Vista</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let registro of registros">
          <!-- Logo de la empresa -->
          <td class="columna1">
            <img
              src="{{ registro.logoEmpresa }}"
              alt="Logo de {{ registro.nombreEmpresa }}"
              class="img-fluid"
            />
          </td>
          <!-- Nombre de la empresa -->
          <td class="columna2">
            {{ recortarTexto(registro.nombreEmpresa) }}
          </td>
          <!-- Oferta de la vacante -->
          <td class="columna3">
            {{ recortarTexto(registro.oferta) }}
          </td>
          <!-- Requisitos -->
          <td class="columna4">
            {{ recortarTexto(registro.requisitos) }}
          </td>
          <!-- Horarios -->
          <td class="columna5">
            {{ recortarTexto(registro.horarios) }}
          </td>
          <!-- Prestaciones -->
          <td class="columna6">
            {{ recortarTexto(registro.prestaciones) }}
          </td>
          <!-- Ubicación -->
          <td class="columna7">
            {{ recortarTexto(registro.ubicacion) }}
          </td>
          <!-- Correos -->
          <td class="columna8">
            {{ recortarTexto(registro.correos) }}
          </td>
          <!-- Teléfonos -->
          <td class="columna9">
            {{ recortarTexto(registro.telefonos) }}
          </td>
          <!-- WhatsApp -->
          <td class="columna10">
            {{ recortarTexto(registro.whatsapp) }}
          </td>
          <td>
            <button
              class="btn btn-secondary"
              (click)="editar(registro)"
              data-bs-toggle="modal"
              data-bs-target="#agregar"
            >
              <i class="bi bi-pencil-square"></i>
            </button>
          </td>
          <td>
            <button
              class="btn btn-success"
              (click)="editar(registro)"
              data-bs-toggle="modal"
              data-bs-target="#preview"
            >
              <i class="bi bi-view-list"></i>
            </button>
          </td>
          <td>
            <button class="btn btn-danger" (click)="eliminar(registro)">
              <i class="bi bi-trash"></i>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div
    class="modal fade"
    id="preview"
    tabindex="-1"
    aria-labelledby="exampleModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-xl">
      <!-- Modal más grande -->
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="exampleModalLabel">Vista previa</h1>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>
        <div class="modal-body">
          <div class="row">
            <!-- ? Lado izquierdo: listado pequeño -->
            <div class="col-md-5">
              <div class="scroll-area">
                <div
                  class="card m-2 p-3"
                  style="max-height: 150px; height: 150px"
                >
                  <div class="row">
                    <div class="col-4">
                      <img
                        src="{{ form.logoEmpresa }}"
                        alt="Logo"
                        style="width: 100px; height: auto"
                      />
                    </div>
                    <div class="col-8">
                      <strong> {{ form.nombreEmpresa }}</strong>
                    </div>
                  </div>
                  <div>
                    <li class="list-group-item">
                      <strong>Oferta de la vacante:</strong>
                      {{ form.oferta }}
                    </li>
                  </div>
                </div>
                <!-- * los restantes -->

                <div *ngFor="let registro of registros">
                  <div
                    class="card m-2 p-3 bg-light"
                    style="max-height: 150px; height: 150px"
                    *ngIf="registro.id !== form.id"
                  >
                    <div class="row">
                      <div class="col-4">
                        <img
                          src="{{ registro.logoEmpresa }}"
                          alt="Logo"
                          style="width: 100px; height: auto"
                        />
                      </div>
                      <div class="col-8">
                        <strong> {{ registro.nombreEmpresa }}</strong>
                      </div>
                    </div>
                    <div>
                      <li class="list-group-item">
                        <strong>Oferta de la vacante:</strong>
                        {{ registro.oferta }}
                      </li>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- ? Lado derecho: información completa -->
            <div class="col-md-7">
              <div class="scroll-area">
                <div class="m-4 p-3 card">
                  <h1 class="m-auto mb-5">{{ form.oferta }}</h1>
                  <div>
                    <div class="row">
                      <div class="col-4">
                        <img
                          src="{{ form.logoEmpresa }}"
                          alt="Logo"
                          style="width: 150px; height: auto"
                        />
                      </div>
                      <div class="col-8">
                        <strong
                          ><h4>{{ form.nombreEmpresa }}</h4></strong
                        >
                      </div>
                    </div>
                    <div *ngIf="form.requisitos !== ''">
                      <strong>Requisitos:</strong>
                      <ul *ngFor="let i of form.requisitos.split('-')">
                        <li>{{ i.trim() }}</li>
                      </ul>
                    </div>

                    <div *ngIf="form.horarios !== ''">
                      <strong>Horarios:</strong>
                      <p>{{ form.horarios }}</p>
                    </div>

                    <div *ngIf="form.prestaciones !== ''">
                      <strong>Prestaciones:</strong>
                      <ul *ngFor="let i of form.prestaciones.split('-')">
                        <li>{{ i.trim() }}</li>
                      </ul>
                    </div>

                    <div *ngIf="form.ubicacion !== ''">
                      <strong>Ubicacion:</strong>
                      <p>{{ form.ubicacion }}</p>
                    </div>

                    <div *ngIf="form.correos !== ''">
                      <strong> <i class="bi bi-envelope"></i> Correos:</strong>
                      <ul *ngFor="let i of form.correos.split('-')">
                        <li>
                          <a href="mailto:{{ i.trim() }}">{{ i.trim() }}</a>
                        </li>
                      </ul>
                    </div>

                    <div *ngIf="form.telefonos !== ''">
                      <strong>
                        <i class="bi bi-telephone-fill"></i> Telefonos:</strong
                      >
                      <ul *ngFor="let i of form.telefonos.split('-')">
                        <li>
                          <a href="tel:{{ i.trim() }}"> {{ i.trim() }}</a>
                        </li>
                      </ul>
                    </div>

                    <div *ngIf="form.whatsapp !== ''">
                      <strong> <i class="bi bi-whatsapp"></i> Whatsapp</strong>
                      <ul *ngFor="let i of form.whatsapp.split('-')">
                        <li>
                          <a href="https://wa.me/{{ i.trim() }}">{{
                            i.trim()
                          }}</a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-secondary"
            data-bs-dismiss="modal"
          >
            Cerrar
          </button>
        </div>
      </div>
    </div>
  </div>
</main>
